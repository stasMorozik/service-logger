!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.core=t():e.core=t()}(this,(()=>(()=>{var e={867:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CrateChatPostgresAdapter=void 0;const i=r(521),n=r(668);t.CrateChatPostgresAdapter=class{constructor(e){this._client=e}async create(e){try{await this._client.query("BEGIN");const t="\n        INSERT INTO chats\n        (id) \n        VALUES($1)\n      ";return await this._client.query(t,[e.chatId]),await this._client.query("COMMIT"),(0,i.right)(!0)}catch(e){if(await this._client.query("ROLLBACK"),"23505"==e.code)return(0,i.left)(new n.InfrastructureError("Chat already exists"));throw e}}}},814:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CretaeLogPostgresAdapter=void 0;const i=r(521);t.CretaeLogPostgresAdapter=class{constructor(e){this._client=e}async create(e){try{await this._client.query("BEGIN");const t="\n        INSERT INTO logs\n        (created, ip, service, level, message) \n        VALUES($1, $2, $3, $4, $5)\n      ";return await this._client.query(t,[e.created,e.ip.value,e.service.value,e.level.value,e.messages]),await this._client.query("COMMIT"),(0,i.right)(!0)}catch(e){throw await this._client.query("ROLLBACK"),e}}}},820:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetLisChatPostgresAdapter=void 0;const i=r(521);t.GetLisChatPostgresAdapter=class{constructor(e){this._client=e}async get(){const e=await this._client.query("SELECT * from chats");return(0,i.right)(e.rows)}}},668:function(e){var t;t=()=>(()=>{"use strict";var e={958:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChatEntity=void 0;const i=r(521),n=r(608);class a{constructor(e){this.chatId=e}static new(e){return"number"!=typeof e?(0,i.left)(new n.DomainError("Invalid id chat")):(0,i.right)(new a(e))}}t.ChatEntity=a},862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FilterDto=void 0,t.FilterDto=class{constructor(e,t,r,i){this.createdFrom=e,this.createdTo=t,this.service=r,this.level=i}}},315:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortingDto=t.PaginationDto=t.FilterDto=void 0;var i=r(862);Object.defineProperty(t,"FilterDto",{enumerable:!0,get:function(){return i.FilterDto}});var n=r(199);Object.defineProperty(t,"PaginationDto",{enumerable:!0,get:function(){return n.PaginationDto}});var a=r(891);Object.defineProperty(t,"SortingDto",{enumerable:!0,get:function(){return a.SortingDto}})},199:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationDto=void 0,t.PaginationDto=class{constructor(e,t){this.page=e,this.limit=t}}},891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortingDto=void 0,t.SortingDto=class{constructor(e,t){this.created=e,this.level=t}}},608:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DomainError=void 0,t.DomainError=class{constructor(e){this.message=e}}},499:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InfrastructureError=t.DomainError=void 0;var i=r(608);Object.defineProperty(t,"DomainError",{enumerable:!0,get:function(){return i.DomainError}});var n=r(303);Object.defineProperty(t,"InfrastructureError",{enumerable:!0,get:function(){return n.InfrastructureError}})},303:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InfrastructureError=void 0,t.InfrastructureError=class{constructor(e){this.message=e}}},513:function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.LogEntity=t.ChatEntity=void 0;var a=r(958);Object.defineProperty(t,"ChatEntity",{enumerable:!0,get:function(){return a.ChatEntity}});var s=r(988);Object.defineProperty(t,"LogEntity",{enumerable:!0,get:function(){return s.LogEntity}}),n(r(315),t),n(r(499),t),n(r(795),t),n(r(998),t)},988:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LogEntity=void 0;const i=r(521),n=r(608),a=r(28),s=r(580),o=r(705);class u{constructor(e,t,r,i,n){this.created=e,this.ip=t,this.service=r,this.level=i,this.messages=n}static new(e,t,r,l,c){if(!new Date(e).getDate())return(0,i.left)(new n.DomainError("Invalid date"));const f=a.IpValueObject.new(t);if(f.isLeft())return(0,i.left)(f.value);const h=o.ServiceValueObject.new(r);if(h.isLeft())return(0,i.left)(h.value);const v=s.LevelValueObject.new(l);return v.isLeft()?(0,i.left)(v.value):"string"!=typeof c?(0,i.left)(new n.DomainError("Invalid message")):(0,i.right)(new u(new Date(e),f.value,h.value,v.value,c))}isDanger(){return this.level.isDanger()}isWarning(){return this.level.isWarning()}}t.LogEntity=u},795:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateChatUseCase=void 0;const i=r(521),n=r(958),a=r(303);t.CreateChatUseCase=class{constructor(e,t){this.createChatPort=e,this.getListChatPort=t}async create(e){const t=await this.getListChatPort.get();if(t.isLeft())return(0,i.left)(t.value);if(t.value.length>=5)return(0,i.left)(new a.InfrastructureError("Chat limit reached"));const r=n.ChatEntity.new(e);return r.isLeft()?(0,i.left)(r.value):this.createChatPort.create(r.value)}}},885:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateLogUseCase=void 0;const i=r(521),n=r(988);t.CreateLogUseCase=class{constructor(e,t,r){this.createLogPort=e,this.getListChatPort=t,this.notifyPort=r}async create(e,t,r,a,s){const o=n.LogEntity.new(e,t,r,a,s);if(o.isLeft())return(0,i.left)(o.value);if(o.isRight()){const e=await this.createLogPort.create(o.value);if(e.isLeft())return(0,i.left)(e.value);if(e.isRight()&&(o.value.isDanger()||o.value.isWarning())){const e=await this.getListChatPort.get();e.isRight()&&this.notifyPort.notify(e.value,`\n                DATE - ${o.value.created}\n                LEVEL - ${o.value.messages}\n                IP - ${o.value.ip.value}\n                SERVICe - ${o.value.service.value}\n                LEVEL - ${o.value.level.value}\n                MESSAGE - ${o.value.messages}\n              `)}}return(0,i.right)(!0)}}},734:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GetListLogsUseCase=void 0;const i=r(521),n=r(608),a=r(45),s=r(135),o=r(400);t.GetListLogsUseCase=class{constructor(e){this.getListLogsPort=e}async get(e,t,r){const u=s.PaginationValueObject.new(e.page,e.limit);if(u.isLeft())return(0,i.left)(u.value);let l=null;if(t){const e=a.FilterValueObject.new(t.createdFrom,t.createdTo,t.service,t.level);if(e.isLeft())return(0,i.left)(e.value);if(e.isRight()&&(l=e.value,l.createdFrom&&l.createdto&&l.createdFrom.getTime()>=l.createdto.getTime()))return(0,i.left)(new n.DomainError("Invalid date period"))}let c=null;if(r){const e=o.SortingValueObject.new(r.created,r.level);if(e.isLeft())return(0,i.left)(e.value);e.isRight()&&(c=e.value)}return this.getListLogsPort.get(u.value,l,c)}}},998:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GetListLogsUseCase=t.CreateLogUseCase=t.CreateChatUseCase=void 0;var i=r(242);Object.defineProperty(t,"CreateChatUseCase",{enumerable:!0,get:function(){return i.CreateChatUseCase}});var n=r(885);Object.defineProperty(t,"CreateLogUseCase",{enumerable:!0,get:function(){return n.CreateLogUseCase}});var a=r(734);Object.defineProperty(t,"GetListLogsUseCase",{enumerable:!0,get:function(){return a.GetListLogsUseCase}})},45:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FilterValueObject=void 0;const i=r(521),n=r(608),a=r(580),s=r(705);class o{constructor(e,t,r,i){this.createdFrom=e,this.createdto=t,this.service=r,this.level=i}static new(e,t,r,u){if(!(e||t||u||r))return(0,i.left)(new n.DomainError("Invalid filter input data"));let l=null;if(e){if(!new Date(e).getDate())return(0,i.left)(new n.DomainError("Invalid date"));l=new Date(e)}let c=null;if(t){if(!new Date(t).getDate())return(0,i.left)(new n.DomainError("Invalid date"));c=new Date(t)}let f=null;if(u){const e=a.LevelValueObject.new(u);if(e.isLeft())return(0,i.left)(e.value);e.mapRight((e=>{f=e}))}let h=null;if(r){const e=s.ServiceValueObject.new(r);if(e.isLeft())return(0,i.left)(e.value);e.mapRight((e=>{h=e}))}return(0,i.right)(new o(l,c,h,f))}}t.FilterValueObject=o},28:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IpValueObject=void 0;const i=r(521),n=r(608);class a{constructor(e){this.value=e}static new(e){return"string"!=typeof e?(0,i.left)(new n.DomainError("Invalid ip")):e.match(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)?(0,i.right)(new a(e)):(0,i.left)(new n.DomainError("Invalid ip"))}}t.IpValueObject=a},580:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LevelValueObject=void 0;const i=r(521),n=r(608);class a{constructor(e){this.value=e}static new(e){if("string"!=typeof e)return(0,i.left)(new n.DomainError("Invalid level"));switch(e){case a.INFO:case a.DEBUG:case a.WARNING:case a.DANGER:return(0,i.right)(new a(e));default:return(0,i.left)(new n.DomainError("Invalid level"))}}isWarning(){return this.value==a.WARNING}isDanger(){return this.value==a.DANGER}}t.LevelValueObject=a,a.INFO="INFO",a.DEBUG="DEBUG",a.WARNING="WARNING",a.DANGER="DANGER"},135:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationValueObject=void 0;const i=r(521),n=r(608);class a{constructor(e,t){this.page=e,this.limit=t}static new(e,t){return"number"!=typeof e?(0,i.left)(new n.DomainError("Invalid page")):"number"!=typeof t?(0,i.left)(new n.DomainError("Invalid limit")):e<1?(0,i.left)(new n.DomainError("Invalid page")):t<1?(0,i.left)(new n.DomainError("Invalid limit")):(0,i.right)(new a(e,t))}}t.PaginationValueObject=a},705:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceValueObject=void 0;const i=r(521),n=r(608);class a{constructor(e){this.value=e}static new(e){return"string"!=typeof e?(0,i.left)(new n.DomainError("Invalid name of service")):e.match(/^[a-zA-Z\w\s]+$/)?(0,i.right)(new a(e)):(0,i.left)(new n.DomainError("Invalid name of service"))}}t.ServiceValueObject=a},400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortingValueObject=void 0;const i=r(521),n=r(608),a=r(580);class s{constructor(e,t){this.created=e,this.level=t}static new(e,t){if(!e&&!t)return(0,i.left)(new n.DomainError("Invalid filter input data"));let r=null;if(e){if(!new Date(e).getDate())return(0,i.left)(new n.DomainError("Invalid date"));r=new Date(e)}let o=null;if(t){const e=a.LevelValueObject.new(t);if(e.isLeft())return(0,i.left)(e.value);e.mapRight((e=>{o=e}))}return(0,i.right)(new s(r,o))}}t.SortingValueObject=s},920:function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(513),t)},521:(e,t)=>{var r;function i(e){return"function"==typeof e.value}Object.defineProperty(t,"__esModule",{value:!0}),t.isEither=t.chain=t.from=t.right=t.left=t.mergeInMany=t.mergeInOne=t.merge=void 0,function(e){e.Left="Left",e.Right="Right"}(r||(r={}));class n{constructor(e,t){this.type=e,this.value=t}static chain(e){return t=>t.asyncChain(e)}static mergeInOne(e){return e.reduce(((e,t)=>e.chain((e=>t.map((t=>e.concat([t])))))),n.right([]))}static mergeInMany(e){return e.reduce(((e,t)=>e.isLeft()?t.isLeft()?n.left(e.value.concat([t.value])):e:t.isLeft()?n.left([t.value]):e.chain((e=>t.map((t=>[...e,t]))))),n.right([]))}static from(e){return n.right(e)}static right(e){return new n("Right",e)}static left(e){return new n("Left",e)}isLeft(){return"Left"===this.type}isRight(){return"Right"===this.type}join(){return this.chain((e=>e))}mapRight(e){return this.map(e)}mapLeft(e){return this.isLeft()?n.left(e(this.value)):n.right(this.value)}map(e){return this.isLeft()?n.left(this.value):n.right(e(this.value))}asyncMap(e){return this.isLeft()?Promise.resolve(n.left(this.value)):e(this.value).then((e=>n.right(e)))}apply(e){if(this.isLeft())return n.left(this.value);if(e.isLeft())return n.left(e.value);if(i(this))return e.map(this.value);if(i(e))return e.apply(this);throw new Error("Some of the arguments should be a function")}asyncApply(e){if(this.isLeft())return Promise.resolve(n.left(this.value));if(e.isLeft())return Promise.resolve(n.left(e.value));if(i(this))return e.map((e=>Promise.resolve(e))).asyncMap((e=>e.then(this.value)));if(i(e))return e.asyncApply(this);throw new Error("Some of the arguments should be a function")}chain(e){return this.isLeft()?n.left(this.value):e(this.value)}asyncChain(e){return this.isLeft()?Promise.resolve(n.left(this.value)):e(this.value)}or(e){return this.isLeft()?e:this}unwrap(){if(this.isRight())return this.value;throw new Error("Either state is Left")}}n.merge=n.mergeInOne,t.merge=n.merge,t.mergeInOne=n.mergeInOne,t.mergeInMany=n.mergeInMany,t.left=n.left,t.right=n.right,t.from=n.from,t.chain=n.chain,t.isEither=e=>e instanceof n}},t={};return function r(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,r),a.exports}(920)})(),e.exports=t()},521:(e,t)=>{"use strict";var r;function i(e){return"function"==typeof e.value}Object.defineProperty(t,"__esModule",{value:!0}),t.isEither=t.chain=t.from=t.right=t.left=t.mergeInMany=t.mergeInOne=t.merge=void 0,function(e){e.Left="Left",e.Right="Right"}(r||(r={}));class n{constructor(e,t){this.type=e,this.value=t}static chain(e){return t=>t.asyncChain(e)}static mergeInOne(e){return e.reduce(((e,t)=>e.chain((e=>t.map((t=>e.concat([t])))))),n.right([]))}static mergeInMany(e){return e.reduce(((e,t)=>e.isLeft()?t.isLeft()?n.left(e.value.concat([t.value])):e:t.isLeft()?n.left([t.value]):e.chain((e=>t.map((t=>[...e,t]))))),n.right([]))}static from(e){return n.right(e)}static right(e){return new n("Right",e)}static left(e){return new n("Left",e)}isLeft(){return"Left"===this.type}isRight(){return"Right"===this.type}join(){return this.chain((e=>e))}mapRight(e){return this.map(e)}mapLeft(e){return this.isLeft()?n.left(e(this.value)):n.right(this.value)}map(e){return this.isLeft()?n.left(this.value):n.right(e(this.value))}asyncMap(e){return this.isLeft()?Promise.resolve(n.left(this.value)):e(this.value).then((e=>n.right(e)))}apply(e){if(this.isLeft())return n.left(this.value);if(e.isLeft())return n.left(e.value);if(i(this))return e.map(this.value);if(i(e))return e.apply(this);throw new Error("Some of the arguments should be a function")}asyncApply(e){if(this.isLeft())return Promise.resolve(n.left(this.value));if(e.isLeft())return Promise.resolve(n.left(e.value));if(i(this))return e.map((e=>Promise.resolve(e))).asyncMap((e=>e.then(this.value)));if(i(e))return e.asyncApply(this);throw new Error("Some of the arguments should be a function")}chain(e){return this.isLeft()?n.left(this.value):e(this.value)}asyncChain(e){return this.isLeft()?Promise.resolve(n.left(this.value)):e(this.value)}or(e){return this.isLeft()?e:this}unwrap(){if(this.isRight())return this.value;throw new Error("Either state is Left")}}n.merge=n.mergeInOne,t.merge=n.merge,t.mergeInOne=n.mergeInOne,t.mergeInMany=n.mergeInMany,t.left=n.left,t.right=n.right,t.from=n.from,t.chain=n.chain,t.isEither=e=>e instanceof n}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,r),a.exports}var i={};return(()=>{"use strict";var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.GetLisChatPostgresAdapter=e.CretaeLogPostgresAdapter=e.CrateChatPostgresAdapter=void 0;var t=r(867);Object.defineProperty(e,"CrateChatPostgresAdapter",{enumerable:!0,get:function(){return t.CrateChatPostgresAdapter}});var n=r(814);Object.defineProperty(e,"CretaeLogPostgresAdapter",{enumerable:!0,get:function(){return n.CretaeLogPostgresAdapter}});var a=r(820);Object.defineProperty(e,"GetLisChatPostgresAdapter",{enumerable:!0,get:function(){return a.GetLisChatPostgresAdapter}})})(),i})()));